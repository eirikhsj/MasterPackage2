---
title: "Untitled"
author: "Eirik Sj√•vik"
date: "2022-12-06"
output: html_document
---

```{r setup, include=FALSE}
library(MasterPackage)
ERA_NWP = get_ERA_NWP(NWP_preds = 2)
save(ERA_NWP, file = 'data/ERA_NWP.Rda')
```

This document tests out 48 different rolling_mod models + 1 external climatology model. 
16 each of: climatology, 1 NWP predictor and 2 NWP predictors.
Have not run any models with only NWP2, just both. 

The results of these tests are that: 
- The best rolling_mod climatology (hour + week + year) is better than the 'look only at the date and time' climatology.
- Including a second NWP-predictor does not seem to help. 
- Only very slight improvement from best climatology gained by using NWP after 30 days. 

- The best model for days 1:60 is an NWP2-model
    - Climatology:      hour + week + year              Loss=9.077675         
    - NWP1:             hour + month                    Loss=8.117373 #Clear improvement            Skill = 0.106
    - NWP2:             hour + week                     Loss=8.072443 #Best
    
- The best model for days 1:30 is an NWP1-model
    - Climatology:      hour + week + year              Loss=9.096479
    - NWP1:             hour                            Loss=7.257886 #Improve from here            Skill = 0.202   
    - NWP2:             hour + week                     Loss=7.275398 

- The best model for days 31:60 is an NWP1-model
    - Climatology:      hour + week + month + year      Loss=9.058161
    - NWP1:             hour + week                     Loss=8.847009 #Slight improvement           Skill = 0.023
    - NWP2:             hour + week                     Loss=8.869488 

- Results are very sensitive to time of year. 
    - Winter is harder to predict, summer is easier, fall and spring are closer to summer (a bit worse)

- Are we doing better vs climatology in certain months?



1:15 16:30 31:45 46:60




#Run models with wave month and week
```{r}
M_9_60_0       = rolling_mod(0.9, ERA_NWP, 0, model = 'reg', window = 60)
M_9_60_1       = rolling_mod(0.9, ERA_NWP, 1, model = 'reg', window = 60)
M_9_60_2       = rolling_mod(0.9, ERA_NWP, 2, model = 'reg', window = 60)

M_9_60_0_h     = rolling_mod(0.9, ERA_NWP, 0, model = 'reg', window = 60, hour_v = TRUE)
M_9_60_1_h     = rolling_mod(0.9, ERA_NWP, 1, model = 'reg', window = 60, hour_v = TRUE)
M_9_60_2_h     = rolling_mod(0.9, ERA_NWP, 2, model = 'reg', window = 60, hour_v = TRUE) 

M_9_60_0_w     = rolling_mod(0.9, ERA_NWP, 0, model = 'reg', window = 60, week_v = TRUE)
M_9_60_1_w     = rolling_mod(0.9, ERA_NWP, 1, model = 'reg', window = 60, week_v = TRUE)
M_9_60_2_w     = rolling_mod(0.9, ERA_NWP, 2, model = 'reg', window = 60, week_v = TRUE)

M_9_60_0_m     = rolling_mod(0.9, ERA_NWP, 0, model = 'reg', window = 60, month_v = TRUE)
M_9_60_1_m     = rolling_mod(0.9, ERA_NWP, 1, model = 'reg', window = 60, month_v = TRUE)
M_9_60_2_m     = rolling_mod(0.9, ERA_NWP, 2, model = 'reg', window = 60, month_v = TRUE) 

M_9_60_0_y     = rolling_mod(0.9, ERA_NWP, 0, model = 'reg', window = 60, year_v = TRUE)
M_9_60_1_y     = rolling_mod(0.9, ERA_NWP, 1, model = 'reg', window = 60, year_v = TRUE)
M_9_60_2_y     = rolling_mod(0.9, ERA_NWP, 2, model = 'reg', window = 60, year_v = TRUE) 

M_9_60_0_h_w   = rolling_mod(0.9, ERA_NWP, 0, model = 'reg', window = 60, hour_v = TRUE, week_v = TRUE) 
M_9_60_1_h_w   = rolling_mod(0.9, ERA_NWP, 1, model = 'reg', window = 60, hour_v = TRUE, week_v = TRUE)
M_9_60_2_h_w   = rolling_mod(0.9, ERA_NWP, 2, model = 'reg', window = 60, hour_v = TRUE, week_v = TRUE)

M_9_60_0_h_m   = rolling_mod(0.9, ERA_NWP, 0, model = 'reg', window = 60, hour_v = TRUE, month_v = TRUE)
M_9_60_1_h_m   = rolling_mod(0.9, ERA_NWP, 1, model = 'reg', window = 60, hour_v = TRUE, month_v = TRUE)
M_9_60_2_h_m   = rolling_mod(0.9, ERA_NWP, 2, model = 'reg', window = 60, hour_v = TRUE, month_v = TRUE)

M_9_60_0_h_y   = rolling_mod(0.9, ERA_NWP, 0, model = 'reg', window = 60, hour_v = TRUE, year_v = TRUE)
M_9_60_1_h_y   = rolling_mod(0.9, ERA_NWP, 1, model = 'reg', window = 60, hour_v = TRUE, year_v = TRUE)
M_9_60_2_h_y   = rolling_mod(0.9, ERA_NWP, 2, model = 'reg', window = 60, hour_v = TRUE, year_v = TRUE)

M_9_60_0_w_m   = rolling_mod(0.9, ERA_NWP, 0, model = 'reg', window = 60, week_v = TRUE, month_v = TRUE)
M_9_60_1_w_m   = rolling_mod(0.9, ERA_NWP, 1, model = 'reg', window = 60, week_v = TRUE, month_v = TRUE)
M_9_60_2_w_m   = rolling_mod(0.9, ERA_NWP, 2, model = 'reg', window = 60, week_v = TRUE, month_v = TRUE)

M_9_60_0_w_y   = rolling_mod(0.9, ERA_NWP, 0, model = 'reg', window = 60, week_v = TRUE, year_v = TRUE)
M_9_60_1_w_y   = rolling_mod(0.9, ERA_NWP, 1, model = 'reg', window = 60, week_v = TRUE, year_v = TRUE)
M_9_60_2_w_y   = rolling_mod(0.9, ERA_NWP, 2, model = 'reg', window = 60, week_v = TRUE, year_v = TRUE)

M_9_60_0_m_y   = rolling_mod(0.9, ERA_NWP, 0, model = 'reg', window = 60, month_v = TRUE, year_v = TRUE)
M_9_60_1_m_y   = rolling_mod(0.9, ERA_NWP, 1, model = 'reg', window = 60, month_v = TRUE, year_v = TRUE)
M_9_60_2_m_y   = rolling_mod(0.9, ERA_NWP, 2, model = 'reg', window = 60, month_v = TRUE, year_v = TRUE)

M_9_60_0_h_w_m  = rolling_mod(0.9, ERA_NWP, 0, model = 'reg', window = 60, hour_v = TRUE, week_v = TRUE, month_v = TRUE) 
M_9_60_1_h_w_m  = rolling_mod(0.9, ERA_NWP, 1, model = 'reg', window = 60, hour_v = TRUE, week_v = TRUE, month_v = TRUE)
M_9_60_2_h_w_m  = rolling_mod(0.9, ERA_NWP, 2, model = 'reg', window = 60, hour_v = TRUE, week_v = TRUE, month_v = TRUE)

M_9_60_0_h_w_y = rolling_mod(0.9, ERA_NWP, 0, model = 'reg', window = 60, hour_v = TRUE, week_v = TRUE, year_v = TRUE)
M_9_60_1_h_w_y = rolling_mod(0.9, ERA_NWP, 1, model = 'reg', window = 60, hour_v = TRUE, week_v = TRUE, year_v = TRUE)
M_9_60_2_h_w_y = rolling_mod(0.9, ERA_NWP, 2, model = 'reg', window = 60, hour_v = TRUE, week_v = TRUE, year_v = TRUE)

M_9_60_0_h_m_y = rolling_mod(0.9, ERA_NWP, 0, model = 'reg', window = 60, hour_v = TRUE, month_v = TRUE, year_v = TRUE)
M_9_60_1_h_m_y = rolling_mod(0.9, ERA_NWP, 1, model = 'reg', window = 60, hour_v = TRUE, month_v = TRUE, year_v = TRUE)
M_9_60_2_h_m_y = rolling_mod(0.9, ERA_NWP, 2, model = 'reg', window = 60, hour_v = TRUE, month_v = TRUE, year_v = TRUE)

M_9_60_0_w_m_y = rolling_mod(0.9, ERA_NWP, 0, model = 'reg', window = 60, week_v = TRUE, month_v = TRUE, year_v = TRUE)
M_9_60_1_w_m_y = rolling_mod(0.9, ERA_NWP, 1, model = 'reg', window = 60, week_v = TRUE, month_v = TRUE, year_v = TRUE)
M_9_60_2_w_m_y = rolling_mod(0.9, ERA_NWP, 2, model = 'reg', window = 60, week_v = TRUE, month_v = TRUE, year_v = TRUE)

M_9_60_0_h_w_m_y = rolling_mod(0.9, ERA_NWP, 0, model = 'reg', window = 60, hour_v = TRUE, week_v = TRUE , month_v = TRUE, year_v = TRUE)
M_9_60_1_h_w_m_y = rolling_mod(0.9, ERA_NWP, 1, model = 'reg', window = 60, hour_v = TRUE, week_v = TRUE , month_v = TRUE, year_v = TRUE)
M_9_60_2_h_w_m_y = rolling_mod(0.9, ERA_NWP, 2, model = 'reg', window = 60, hour_v = TRUE, week_v = TRUE , month_v = TRUE, year_v = TRUE)
```


#Saved
```{r}
#Simple
save(M_9_60_0, file = 'model_output_data/M_9_60_0.Rda')
save(M_9_60_1, file = 'model_output_data/M_9_60_1.Rda')
save(M_9_60_2, file = 'model_output_data/M_9_60_2.Rda')

#Week
save(M_9_60_0_w, file = 'model_output_data/M_9_60_0_w.Rda')
save(M_9_60_1_w, file = 'model_output_data/M_9_60_1_w.Rda')
save(M_9_60_2_w, file = 'model_output_data/M_9_60_2_w.Rda')

#Month
save(M_9_60_0_m, file = 'model_output_data/M_9_60_0_m.Rda')
save(M_9_60_1_m, file = 'model_output_data/M_9_60_1_m.Rda')
save(M_9_60_2_m, file = 'model_output_data/M_9_60_2_m.Rda')

#Hour
save(M_9_60_0_h, file = 'model_output_data/M_9_60_0_h.Rda')
save(M_9_60_1_h, file = 'model_output_data/M_9_60_1_h.Rda')
save(M_9_60_2_h, file = 'model_output_data/M_9_60_2_h.Rda')

#Year
save(M_9_60_0_y, file = 'model_output_data/M_9_60_0_y.Rda')
save(M_9_60_1_y, file = 'model_output_data/M_9_60_1_y.Rda')
save(M_9_60_2_y, file = 'model_output_data/M_9_60_2_y.Rda')

#Hour and week
save(M_9_60_0_h_w, file = 'model_output_data/M_9_60_0_h_w.Rda')
save(M_9_60_1_h_w, file = 'model_output_data/M_9_60_1_h_w.Rda')
save(M_9_60_2_h_w, file = 'model_output_data/M_9_60_2_h_w.Rda')

#Hour and month
save(M_9_60_0_h_m, file = 'model_output_data/M_9_60_0_h_m.Rda')
save(M_9_60_1_h_m, file = 'model_output_data/M_9_60_1_h_m.Rda')
save(M_9_60_2_h_m, file = 'model_output_data/M_9_60_2_h_m.Rda')

#Hour and year
save(M_9_60_0_h_y, file = 'model_output_data/M_9_60_0_h_y.Rda')
save(M_9_60_1_h_y, file = 'model_output_data/M_9_60_1_h_y.Rda')
save(M_9_60_2_h_y, file = 'model_output_data/M_9_60_2_h_y.Rda')

#Week and month
save(M_9_60_0_w_m, file = 'model_output_data/M_9_60_0_w_m.Rda')
save(M_9_60_1_w_m, file = 'model_output_data/M_9_60_1_w_m.Rda')
save(M_9_60_2_w_m, file = 'model_output_data/M_9_60_2_w_m.Rda')

#Week and year
save(M_9_60_0_w_y, file = 'model_output_data/M_9_60_0_w_y.Rda')
save(M_9_60_1_w_y, file = 'model_output_data/M_9_60_1_w_y.Rda')
save(M_9_60_2_w_y, file = 'model_output_data/M_9_60_2_w_y.Rda')

#Month and year
save(M_9_60_0_m_y, file = 'model_output_data/M_9_60_0_m_y.Rda')
save(M_9_60_1_m_y, file = 'model_output_data/M_9_60_1_m_y.Rda')
save(M_9_60_2_m_y, file = 'model_output_data/M_9_60_2_m_y.Rda')

#Hour, week and month 
save(M_9_60_0_h_w_m, file = 'model_output_data/M_9_60_0_h_w_m.Rda')
save(M_9_60_1_h_w_m, file = 'model_output_data/M_9_60_1_h_w_m.Rda')
save(M_9_60_2_h_w_m, file = 'model_output_data/M_9_60_2_h_w_m.Rda')

#Hour, week and year 
save(M_9_60_0_h_w_y, file = 'model_output_data/M_9_60_0_h_w_y.Rda')
save(M_9_60_1_h_w_y, file = 'model_output_data/M_9_60_1_h_w_y.Rda')
save(M_9_60_2_h_w_y, file = 'model_output_data/M_9_60_2_h_w_y.Rda')

#Hour, month and year 
save(M_9_60_0_h_m_y, file = 'model_output_data/M_9_60_0_h_m_y.Rda')
save(M_9_60_1_h_m_y, file = 'model_output_data/M_9_60_1_h_m_y.Rda')
save(M_9_60_2_h_m_y, file = 'model_output_data/M_9_60_2_h_m_y.Rda')

#Week, month and year 
save(M_9_60_0_w_m_y, file = 'model_output_data/M_9_60_0_w_m_y.Rda')
save(M_9_60_1_w_m_y, file = 'model_output_data/M_9_60_1_w_m_y.Rda')
save(M_9_60_2_w_m_y, file = 'model_output_data/M_9_60_2_w_m_y.Rda')

#Hour, week, month and year 
save(M_9_60_0_h_w_m_y, file = 'model_output_data/M_9_60_0_h_w_m_y.Rda')
save(M_9_60_1_h_w_m_y, file = 'model_output_data/M_9_60_1_h_w_m_y.Rda')
save(M_9_60_2_h_w_m_y, file = 'model_output_data/M_9_60_2_h_w_m_y.Rda')
```

# load
```{r}
#Simple
load('model_output_data/M_9_60_0.Rda')
load('model_output_data/M_9_60_1.Rda')
load('model_output_data/M_9_60_2.Rda')

#Week
load('model_output_data/M_9_60_0_w.Rda')
load('model_output_data/M_9_60_1_w.Rda')
load('model_output_data/M_9_60_2_w.Rda')

#Month
load('model_output_data/M_9_60_0_m.Rda')
load('model_output_data/M_9_60_1_m.Rda')
load('model_output_data/M_9_60_2_m.Rda')

#Hour
load('model_output_data/M_9_60_0_h.Rda')
load('model_output_data/M_9_60_1_h.Rda')
load('model_output_data/M_9_60_2_h.Rda')

#Year
load('model_output_data/M_9_60_0_y.Rda')
load('model_output_data/M_9_60_1_y.Rda')
load('model_output_data/M_9_60_2_y.Rda')

#Hour and week
load('model_output_data/M_9_60_0_h_w.Rda')
load('model_output_data/M_9_60_1_h_w.Rda')
load('model_output_data/M_9_60_2_h_w.Rda')

#Hour and month
load('model_output_data/M_9_60_0_h_m.Rda')
load('model_output_data/M_9_60_1_h_m.Rda')
load('model_output_data/M_9_60_2_h_m.Rda')

#Hour and year
load('model_output_data/M_9_60_0_h_y.Rda')
load('model_output_data/M_9_60_1_h_y.Rda')
load('model_output_data/M_9_60_2_h_y.Rda')

#Week and month
load('model_output_data/M_9_60_0_w_m.Rda')
load('model_output_data/M_9_60_1_w_m.Rda')
load('model_output_data/M_9_60_2_w_m.Rda')

#Week and year
load('model_output_data/M_9_60_0_w_y.Rda')
load('model_output_data/M_9_60_1_w_y.Rda')
load('model_output_data/M_9_60_2_w_y.Rda')

#Month and year
load('model_output_data/M_9_60_0_m_y.Rda')
load('model_output_data/M_9_60_1_m_y.Rda')
load('model_output_data/M_9_60_2_m_y.Rda')

#Hour, week and month 
load('model_output_data/M_9_60_0_h_w_m.Rda')
load('model_output_data/M_9_60_1_h_w_m.Rda')
load('model_output_data/M_9_60_2_h_w_m.Rda')

#Hour, week and year 
load('model_output_data/M_9_60_0_h_w_y.Rda')
load('model_output_data/M_9_60_1_h_w_y.Rda')
load('model_output_data/M_9_60_2_h_w_y.Rda')

#Hour, month and year 
load('model_output_data/M_9_60_0_h_m_y.Rda')
load('model_output_data/M_9_60_1_h_m_y.Rda')
load('model_output_data/M_9_60_2_h_m_y.Rda')

#Week, month and year 
load('model_output_data/M_9_60_0_w_m_y.Rda')
load('model_output_data/M_9_60_1_w_m_y.Rda')
load('model_output_data/M_9_60_2_w_m_y.Rda')

#Hour, week, month and year 
load('model_output_data/M_9_60_0_h_w_m_y.Rda')
load('model_output_data/M_9_60_1_h_w_m_y.Rda')
load('model_output_data/M_9_60_2_h_w_m_y.Rda')
```


# Plot
```{r, cache = TRUE}
#  Intercept + NWP1 + NWP 2
plot_rolling0 = M_9_60_0$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
plot_rolling1 = M_9_60_1$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
plot_rolling2 = M_9_60_2$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]

#  Intercept + hour + NWP1 + NWP 2
plot_rolling0_h = M_9_60_0_h$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
plot_rolling1_h = M_9_60_1_h$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
plot_rolling2_h = M_9_60_2_h$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
#  Intercept + week + NWP1 + NWP 2
plot_rolling0_w = M_9_60_0_w$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
plot_rolling1_w = M_9_60_1_w$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
plot_rolling2_w = M_9_60_2_w$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
#  Intercept + month + NWP1 + NWP 2
plot_rolling0_m = M_9_60_0_m$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
plot_rolling1_m = M_9_60_1_m$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
plot_rolling2_m = M_9_60_2_m$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
#  Intercept + year + NWP1 + NWP 2
plot_rolling0_y = M_9_60_0_y$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
plot_rolling1_y = M_9_60_1_y$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
plot_rolling2_y = M_9_60_2_y$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]

#  Intercept + hour + week + NWP1 + NWP2
plot_rolling0_h_w = M_9_60_0_h_w$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
plot_rolling1_h_w = M_9_60_1_h_w$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
plot_rolling2_h_w = M_9_60_2_h_w$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
#  Intercept + hour + month + NWP1 + NWP2
plot_rolling0_h_m = M_9_60_0_h_m$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
plot_rolling1_h_m = M_9_60_1_h_m$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
plot_rolling2_h_m = M_9_60_2_h_m$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
#  Intercept + hour + year + NWP1 + NWP2
plot_rolling0_h_y = M_9_60_0_h_y$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
plot_rolling1_h_y = M_9_60_1_h_y$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
plot_rolling2_h_y = M_9_60_2_h_y$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]

#  Intercept + week + month + NWP1 + NWP2
plot_rolling0_w_m = M_9_60_0_w_m$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
plot_rolling1_w_m = M_9_60_1_w_m$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
plot_rolling2_w_m = M_9_60_2_w_m$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
#  Intercept + week + year + NWP1 + NWP2
plot_rolling0_w_y = M_9_60_0_w_y$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
plot_rolling1_w_y = M_9_60_1_w_y$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
plot_rolling2_w_y = M_9_60_2_w_y$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
#  Intercept + month + year + NWP1 + NWP2
plot_rolling0_m_y = M_9_60_0_m_y$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
plot_rolling1_m_y = M_9_60_1_m_y$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
plot_rolling2_m_y = M_9_60_2_m_y$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]

#Intercept + hour + week + month + NWP1 + NWP2
plot_rolling0_h_w_m = M_9_60_0_h_w_m$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
plot_rolling1_h_w_m = M_9_60_1_h_w_m$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
plot_rolling2_h_w_m = M_9_60_2_h_w_m$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
#Intercept + hour + week + year + NWP1 + NWP2
plot_rolling0_h_w_y = M_9_60_0_h_w_y$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
plot_rolling1_h_w_y = M_9_60_1_h_w_y$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
plot_rolling2_h_w_y = M_9_60_2_h_w_y$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
#Intercept + hour + month + year + NWP1 + NWP2
plot_rolling0_h_m_y = M_9_60_0_h_m_y$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
plot_rolling1_h_m_y = M_9_60_1_h_m_y$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
plot_rolling2_h_m_y = M_9_60_2_h_m_y$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
#Intercept + week + month + year + NWP1 + NWP2
plot_rolling0_w_m_y = M_9_60_0_w_m_y$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
plot_rolling1_w_m_y = M_9_60_1_w_m_y$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
plot_rolling2_w_m_y = M_9_60_2_w_m_y$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]

#Intercept + hour + week + month + year + NWP1 + NWP2
plot_rolling0_h_w_m_y = M_9_60_0_h_w_m_y$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
plot_rolling1_h_w_m_y = M_9_60_1_h_w_m_y$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
plot_rolling2_h_w_m_y = M_9_60_2_h_w_m_y$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
```

```{r}
low = 1
upp = 240
ax = seq(low, upp, length.out = 5)
#  Intercept + NWP1 + NWP2
matplot(low:upp, plot_rolling1[low:upp,mean_test_loss] , type = 'l', ylim = c(0, 25), lty = 1,
        xaxt = 'n', xlab = 'Horizon (days)', ylab = 'Pinball loss', main = 'Intercept + NWP1 + NWP2 : 60 day window (Test)', col = 'brown1')
axis(1, at = ax, labels = ax/4)
legend("bottomleft", lty = 1, cex=0.6, col = c('black', 'brown1', 'dodgerblue1'),
       legend = c('Climatology', '1 NWP pred', '2 NWP preds'))
matlines(low:upp, plot_rolling0[low:upp,mean_test_loss], col = 'black', lty = 1)
matlines(low:upp, plot_rolling2[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 2)

#  Intercept + week + NWP1 + NWP2
matplot(low:upp, plot_rolling1_w[low:upp,mean_test_loss] , type = 'l', ylim = c(0, 25), lty = 1,
        xaxt = 'n', xlab = 'Horizon (days)', ylab = 'Pinball loss', main = 'Intercept + week + NWP1 + NWP2: 60 day window (Test)', col = 'brown1')
axis(1, at = ax, labels = ax/4)
legend("bottomleft", lty = 1, cex=0.6, col = c('black', 'brown1', 'dodgerblue1'),
       legend = c('Climatology', '1 NWP pred', '2 NWP preds'))
matlines(low:upp, plot_rolling0_w[low:upp,mean_test_loss], col = 'black', lty = 1)
matlines(low:upp, plot_rolling2_w[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 2)

#  Intercept + hour + NWP1 + NWP2
matplot(low:upp, plot_rolling1_h[low:upp,mean_test_loss] , type = 'l', ylim = c(0, 25), lty = 1,
        xaxt = 'n', xlab = 'Horizon (days)', ylab = 'Pinball loss', main = 'Intercept + hour + NWP1 + NWP2: 60 day window (Test)', col = 'brown1')
axis(1, at = ax, labels = ax/4)
legend("bottomleft", lty = 1, cex=0.6, col = c('black', 'brown1', 'dodgerblue1'),
       legend = c('Climatology', '1 NWP pred', '2 NWP preds'))
matlines(low:upp, plot_rolling0_h[low:upp,mean_test_loss], col = 'black', lty = 1)
matlines(low:upp, plot_rolling2_h[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 2)

#  Intercept + month + NWP1 + NWP2
matplot(low:upp, plot_rolling1_m[low:upp,mean_test_loss] , type = 'l', ylim = c(0, 25), lty = 1, xaxt = 'n',
        xlab = 'Horizon (days)', ylab = 'Pinball loss', main = 'Intercept + month + NWP1 + NWP2: 60 day window (Test)', col = 'brown1')
axis(1, at = ax, labels = ax/4)
legend("bottomleft", lty = 1, cex=0.6, col = c('black', 'brown1', 'dodgerblue1'),
       legend = c('Climatology', '1 NWP pred', '2 NWP preds'))
matlines(low:upp, plot_rolling0_m[low:upp,mean_test_loss], col = 'black', lty = 1)
matlines(low:upp, plot_rolling2_m[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 2)

#  Intercept + year + NWP1 + NWP2
matplot(low:upp, plot_rolling1_y[low:upp,mean_test_loss] , type = 'l', ylim = c(0, 25), lty = 1, xaxt = 'n',
        xlab = 'Horizon (days)', ylab = 'Pinball loss', main = 'Intercept + year + NWP1 + NWP2: 60 day window (Test)', col = 'brown1')
axis(1, at = ax, labels = ax/4)
legend("bottomleft", lty = 1, cex=0.6, col = c('black', 'brown1', 'dodgerblue1'),
       legend = c('Climatology', '1 NWP pred', '2 NWP preds'))
matlines(low:upp, plot_rolling0_y[low:upp,mean_test_loss], col = 'black', lty = 1)
matlines(low:upp, plot_rolling2_y[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 2)

#  Intercept + hour + week + NWP1 + NWP2
matplot(low:upp, plot_rolling1_h_w[low:upp,mean_test_loss] , type = 'l', ylim = c(0, 25), lty = 1, xaxt = 'n', 
        xlab = 'Horizon (days)', ylab = 'Pinball loss', main = 'Intercept + hour + week + NWP1 + NWP2: 60 day window (Test)', col = 'brown1')
axis(1, at = ax, labels = ax/4)
legend("bottomleft", lty = 1, cex=0.6, col = c('black', 'brown1', 'dodgerblue1'),
       legend = c('Climatology', '1 NWP pred', '2 NWP preds'))
matlines(low:upp, plot_rolling0_h_w[low:upp,mean_test_loss], col = 'black', lty = 1)
matlines(low:upp, plot_rolling2_h_w[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 2)

#  Intercept + hour + month + NWP1 + NWP2
matplot(low:upp, plot_rolling1_h_m[low:upp,mean_test_loss] , type = 'l', ylim = c(0, 25), lty = 1, xaxt = 'n', 
        xlab = 'Horizon (days)', ylab = 'Pinball loss', main = 'Intercept + hour + month + NWP1 + NWP2: 60 day window (Test)', col = 'brown1')
axis(1, at = ax, labels = ax/4)
legend("bottomleft", lty = 1, cex=0.6, col = c('black', 'brown1', 'dodgerblue1'),
       legend = c('Climatology', '1 NWP pred', '2 NWP preds'))
matlines(low:upp, plot_rolling0_h_m[low:upp,mean_test_loss], col = 'black', lty = 1)
matlines(low:upp, plot_rolling2_h_m[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 2)

#  Intercept + hour + year + NWP1 + NWP2
matplot(low:upp, plot_rolling1_h_y[low:upp,mean_test_loss] , type = 'l', ylim = c(0, 25), lty = 1, xaxt = 'n', 
        xlab = 'Horizon (days)', ylab = 'Pinball loss', main = 'Intercept + hour + year + NWP1 + NWP2: 60 day window (Test)', col = 'brown1')
axis(1, at = ax, labels = ax/4)
legend("bottomleft", lty = 1, cex=0.6, col = c('black', 'brown1', 'dodgerblue1'),
       legend = c('Climatology', '1 NWP pred', '2 NWP preds'))
matlines(low:upp, plot_rolling0_h_y[low:upp,mean_test_loss], col = 'black', lty = 1)
matlines(low:upp, plot_rolling2_h_y[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 2)

#  Intercept + week + month + NWP1 + NWP2
matplot(low:upp, plot_rolling1_w_m[low:upp,mean_test_loss] , type = 'l', ylim = c(0, 25), lty = 1, xaxt = 'n', 
        xlab = 'Horizon (days)', ylab = 'Pinball loss', main = 'Intercept + week + month + NWP1 + NWP2: 60 day window (Test)', col = 'brown1')
axis(1, at = ax, labels = ax/4)
legend("bottomleft", lty = 1, cex=0.6, col = c('black', 'brown1', 'dodgerblue1'),
       legend = c('Climatology', '1 NWP pred', '2 NWP preds'))
matlines(low:upp, plot_rolling0_w_m[low:upp,mean_test_loss], col = 'black', lty = 1)
matlines(low:upp, plot_rolling2_w_m[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 2)

#  Intercept + week + year + NWP1 + NWP2
matplot(low:upp, plot_rolling1_w_y[low:upp,mean_test_loss] , type = 'l', ylim = c(0, 25), lty = 1, xaxt = 'n', 
        xlab = 'Horizon (days)', ylab = 'Pinball loss', main = 'Intercept + week + year + NWP1 + NWP2: 60 day window (Test)', col = 'brown1')
axis(1, at = ax, labels = ax/4)
legend("bottomleft", lty = 1, cex=0.6, col = c('black', 'brown1', 'dodgerblue1'),
       legend = c('Climatology', '1 NWP pred', '2 NWP preds'))
matlines(low:upp, plot_rolling0_w_y[low:upp,mean_test_loss], col = 'black', lty = 1)
matlines(low:upp, plot_rolling2_w_y[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 2)

#  Intercept + month + year + NWP1 + NWP2
matplot(low:upp, plot_rolling1_m_y[low:upp,mean_test_loss] , type = 'l', ylim = c(0, 25), lty = 1, xaxt = 'n', 
        xlab = 'Horizon (days)', ylab = 'Pinball loss', main = 'Intercept + month + year + NWP1 + NWP2: 60 day window (Test)', col = 'brown1')
axis(1, at = ax, labels = ax/4)
legend("bottomleft", lty = 1, cex=0.6, col = c('black', 'brown1', 'dodgerblue1'),
       legend = c('Climatology', '1 NWP pred', '2 NWP preds'))
matlines(low:upp, plot_rolling0_m_y[low:upp,mean_test_loss], col = 'black', lty = 1)
matlines(low:upp, plot_rolling2_m_y[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 2)

#  Intercept + hour + week + month + NWP1 + NWP2
matplot(low:upp, plot_rolling1_h_w_m[low:upp,mean_test_loss] , type = 'l', ylim = c(0, 25), lty = 1, xaxt = 'n', 
        xlab = 'Horizon (days)', ylab = 'Pinball loss', main = 'Intercept + hour + week + month + NWP1 + NWP2: 60 day window (Test)', col = 'brown1')
axis(1, at = ax, labels = ax/4)
legend("bottomleft", lty = 1, cex=0.6, col = c('black', 'brown1', 'dodgerblue1'),
       legend = c('Climatology', '1 NWP pred', '2 NWP preds'))
matlines(low:upp, plot_rolling0_h_w_m[low:upp,mean_test_loss], col = 'black', lty = 1)
matlines(low:upp, plot_rolling2_h_w_m[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 2)

#  Intercept + hour + week + year + NWP1 + NWP2
matplot(low:upp, plot_rolling1_h_w_y[low:upp,mean_test_loss] , type = 'l', ylim = c(0, 25), lty = 1, xaxt = 'n', 
        xlab = 'Horizon (days)', ylab = 'Pinball loss', main = 'Intercept + hour + week + year + NWP1 + NWP2: 60 day window (Test)', col = 'brown1')
axis(1, at = ax, labels = ax/4)
legend("bottomleft", lty = 1, cex=0.6, col = c('black', 'brown1', 'dodgerblue1'),
       legend = c('Climatology', '1 NWP pred', '2 NWP preds'))
matlines(low:upp, plot_rolling0_h_w_y[low:upp,mean_test_loss], col = 'black', lty = 1)
matlines(low:upp, plot_rolling2_h_w_y[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 2)

#  Intercept + hour + month + year + NWP1 + NWP2
matplot(low:upp, plot_rolling1_h_m_y[low:upp,mean_test_loss] , type = 'l', ylim = c(0, 25), lty = 1, xaxt = 'n', 
        xlab = 'Horizon (days)', ylab = 'Pinball loss', main = 'Intercept + hour + month + year + NWP1 + NWP2: 60 day window (Test)', col = 'brown1')
axis(1, at = ax, labels = ax/4)
legend("bottomleft", lty = 1, cex=0.6, col = c('black', 'brown1', 'dodgerblue1'),
       legend = c('Climatology', '1 NWP pred', '2 NWP preds'))
matlines(low:upp, plot_rolling0_h_m_y[low:upp,mean_test_loss], col = 'black', lty = 1)
matlines(low:upp, plot_rolling2_h_m_y[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 2)
#  Intercept + week + month + year + NWP1 + NWP2
matplot(low:upp, plot_rolling1_w_m_y[low:upp,mean_test_loss] , type = 'l', ylim = c(0, 25), lty = 1, xaxt = 'n', 
        xlab = 'Horizon (days)', ylab = 'Pinball loss', main = 'Intercept + hour + week + year + NWP1 + NWP2: 60 day window (Test)', col = 'brown1')
axis(1, at = ax, labels = ax/4)
legend("bottomleft", lty = 1, cex=0.6, col = c('black', 'brown1', 'dodgerblue1'),
       legend = c('Climatology', '1 NWP pred', '2 NWP preds'))
matlines(low:upp, plot_rolling0_w_m_y[low:upp,mean_test_loss], col = 'black', lty = 1)
matlines(low:upp, plot_rolling2_w_m_y[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 2)


#  Intercept + hour +week + month + year + NWP1 + NWP2
matplot(low:upp, plot_rolling1_h_w_m_y[low:upp,mean_test_loss] , type = 'l', ylim = c(0, 25), lty = 1, xaxt = 'n', 
        xlab = 'Horizon (days)', ylab = 'Pinball loss', main = 'Intercept + hour + week + month +year + NWP1 + NWP2: 60 day window (Test)', col = 'brown1')
axis(1, at = ax, labels = ax/4)
legend("bottomleft", lty = 1, cex=0.6, col = c('black', 'brown1', 'dodgerblue1'),
       legend = c('Climatology', '1 NWP pred', '2 NWP preds'))
matlines(low:upp, plot_rolling0_h_w_m_y[low:upp,mean_test_loss], col = 'black', lty = 1)
matlines(low:upp, plot_rolling2_h_w_m_y[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 2)
```

```{r}
matplot(low:upp, plot_rolling0_w[low:upp,mean_test_loss], col = 'white', type = 'l', lty = 1, ylim = c(7.3,10.4))

#matlines(low:upp, plot_rolling0[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 1)
#matlines(low:upp, plot_rolling0_h[low:upp,mean_test_loss], col = 'brown1', lty = 1)
#matlines(low:upp, plot_rolling0_m[low:upp,mean_test_loss], col = 'brown1', lty = 1)
#matlines(low:upp, plot_rolling0_y[low:upp,mean_test_loss], col = 'brown1', lty = 1)

matlines(low:upp, plot_rolling0_h_w[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 1)
#matlines(low:upp, plot_rolling0_h_m[low:upp,mean_test_loss], col = 'pink', lty = 1)
#matlines(low:upp, plot_rolling0_h_y[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 1)

#matlines(low:upp, plot_rolling0_w_m[low:upp,mean_test_loss], col = 'purple', lty = 1)
#matlines(low:upp, plot_rolling0_w_y[low:upp,mean_test_loss], col = 'orange', lty = 1)
#matlines(low:upp, plot_rolling0_m_y[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 1)

#matlines(low:upp, plot_rolling0_h_w_m[low:upp,mean_test_loss], col = 'green', lty = 1)
matlines(low:upp, plot_rolling0_h_w_y[low:upp,mean_test_loss], col = 'black', lty = 2) #best model 
#matlines(low:upp, plot_rolling0_h_m_y[low:upp,mean_test_loss], col = 'red', lty = 1)
#matlines(low:upp, plot_rolling0_w_m_y[low:upp,mean_test_loss], col = 'red', lty = 1)

matlines(low:upp, plot_rolling0_h_w_m_y[low:upp,mean_test_loss], col = 'red', lty = 2)

low = 1
upp = 240
mean(plot_rolling0_h_w_m_y[low:upp,mean_test_loss]) #9.080236
mean(plot_rolling0_h_w_m[low:upp,mean_test_loss])
mean(plot_rolling0_h_w_y[low:upp,mean_test_loss])  #Best climatology model over first 60 days 9.077675
mean(plot_rolling0_h_w[low:upp,mean_test_loss])
mean(plot_rolling0_w[low:upp,mean_test_loss])

low = 1
upp = 120
mean(plot_rolling0_h_w_m_y[low:upp,mean_test_loss]) #9.102311
mean(plot_rolling0_h_w_m[low:upp,mean_test_loss])
mean(plot_rolling0_h_w_y[low:upp,mean_test_loss]) #Best climatology model over first 30 days 9.096479
mean(plot_rolling0_h_w[low:upp,mean_test_loss])
mean(plot_rolling0_w[low:upp,mean_test_loss])
low = 121
upp = 240
mean(plot_rolling0_h_w_m_y[low:upp,mean_test_loss]) #Best climatology model over 30- 60 days 9.058161
mean(plot_rolling0_h_w_m[low:upp,mean_test_loss])
mean(plot_rolling0_h_w_y[low:upp,mean_test_loss]) # Almost the same 9.058871
mean(plot_rolling0_h_w[low:upp,mean_test_loss])
mean(plot_rolling0_w[low:upp,mean_test_loss])

```

```{r}
matplot(low:upp, plot_rolling1[low:upp,mean_test_loss], col = 'brown1', type = 'l', lty = 1)

matlines(low:upp, plot_rolling1_w[low:upp,mean_test_loss], col = 'brown1', lty = 1)
matlines(low:upp, plot_rolling1_h[low:upp,mean_test_loss], col = 'brown1', lty = 1)
matlines(low:upp, plot_rolling1_m[low:upp,mean_test_loss], col = 'brown1', lty = 1)
matlines(low:upp, plot_rolling1_y[low:upp,mean_test_loss], col = 'brown1', lty = 1)

matlines(low:upp, plot_rolling1_h_w[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 1)
matlines(low:upp, plot_rolling1_h_m[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 1)
matlines(low:upp, plot_rolling1_h_y[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 1)

matlines(low:upp, plot_rolling1_w_m[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 1)
matlines(low:upp, plot_rolling1_w_y[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 1)
matlines(low:upp, plot_rolling1_m_y[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 1)

matlines(low:upp, plot_rolling1_h_w_m[low:upp,mean_test_loss], col = 'green', lty = 1)
matlines(low:upp, plot_rolling1_h_w_y[low:upp,mean_test_loss], col = 'green', lty = 1)
matlines(low:upp, plot_rolling1_h_m_y[low:upp,mean_test_loss], col = 'green', lty = 1)
matlines(low:upp, plot_rolling1_w_m_y[low:upp,mean_test_loss], col = 'green', lty = 1)

matlines(low:upp, plot_rolling1_h_w_m_y[low:upp,mean_test_loss], col = 'green', lty = 1)

low = 1
upp = 240
mean(plot_rolling1[low:upp,mean_test_loss])
mean(plot_rolling1_w[low:upp,mean_test_loss])
mean(plot_rolling1_h[low:upp,mean_test_loss])
mean(plot_rolling1_m[low:upp,mean_test_loss])
mean(plot_rolling1_y[low:upp,mean_test_loss])

mean(plot_rolling1_h_w[low:upp,mean_test_loss])
mean(plot_rolling1_h_m[low:upp,mean_test_loss]) #Best 8.117373
mean(plot_rolling1_h_y[low:upp,mean_test_loss])

mean(plot_rolling1_w_m[low:upp,mean_test_loss])
mean(plot_rolling1_w_y[low:upp,mean_test_loss])
mean(plot_rolling1_m_y[low:upp,mean_test_loss])

mean(plot_rolling1_h_w_m[low:upp,mean_test_loss])
mean(plot_rolling1_h_w_y[low:upp,mean_test_loss])
mean(plot_rolling1_h_m_y[low:upp,mean_test_loss])
mean(plot_rolling1_w_m_y[low:upp,mean_test_loss])

mean(plot_rolling1_h_w_m_y[low:upp,mean_test_loss])

low = 1
upp = 120
mean(plot_rolling1[low:upp,mean_test_loss])
mean(plot_rolling1_w[low:upp,mean_test_loss])
mean(plot_rolling1_h[low:upp,mean_test_loss]) #Best 7.257886
mean(plot_rolling1_m[low:upp,mean_test_loss])
mean(plot_rolling1_y[low:upp,mean_test_loss])

mean(plot_rolling1_h_w[low:upp,mean_test_loss])
mean(plot_rolling1_h_m[low:upp,mean_test_loss]) 
mean(plot_rolling1_h_y[low:upp,mean_test_loss])

mean(plot_rolling1_w_m[low:upp,mean_test_loss])
mean(plot_rolling1_w_y[low:upp,mean_test_loss])
mean(plot_rolling1_m_y[low:upp,mean_test_loss])

mean(plot_rolling1_h_w_m[low:upp,mean_test_loss])
mean(plot_rolling1_h_w_y[low:upp,mean_test_loss])
mean(plot_rolling1_h_m_y[low:upp,mean_test_loss])
mean(plot_rolling1_w_m_y[low:upp,mean_test_loss])

mean(plot_rolling1_h_w_m_y[low:upp,mean_test_loss])

low = 121
upp = 240
mean(plot_rolling1[low:upp,mean_test_loss])
mean(plot_rolling1_w[low:upp,mean_test_loss])
mean(plot_rolling1_h[low:upp,mean_test_loss]) 
mean(plot_rolling1_m[low:upp,mean_test_loss])
mean(plot_rolling1_y[low:upp,mean_test_loss])

mean(plot_rolling1_h_w[low:upp,mean_test_loss]) #Best 8.847009
mean(plot_rolling1_h_m[low:upp,mean_test_loss]) 
mean(plot_rolling1_h_y[low:upp,mean_test_loss])

mean(plot_rolling1_w_m[low:upp,mean_test_loss])
mean(plot_rolling1_w_y[low:upp,mean_test_loss])
mean(plot_rolling1_m_y[low:upp,mean_test_loss])

mean(plot_rolling1_h_w_m[low:upp,mean_test_loss])
mean(plot_rolling1_h_w_y[low:upp,mean_test_loss])
mean(plot_rolling1_h_m_y[low:upp,mean_test_loss])
mean(plot_rolling1_w_m_y[low:upp,mean_test_loss])

mean(plot_rolling1_h_w_m_y[low:upp,mean_test_loss])
```

```{r}
matplot(low:upp, plot_rolling2[low:upp,mean_test_loss], col = 'dodgerblue1', type = 'l', lty = 1)

matlines(low:upp, plot_rolling2_w[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 1)
matlines(low:upp, plot_rolling2_h[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 1)
matlines(low:upp, plot_rolling2_m[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 1)
matlines(low:upp, plot_rolling2_y[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 1)

matlines(low:upp, plot_rolling2_h_w[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 1)
matlines(low:upp, plot_rolling2_h_m[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 1)
matlines(low:upp, plot_rolling2_h_y[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 1)

matlines(low:upp, plot_rolling2_w_m[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 1)
matlines(low:upp, plot_rolling2_w_y[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 1)
matlines(low:upp, plot_rolling2_m_y[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 1)

matlines(low:upp, plot_rolling2_h_w_m[low:upp,mean_test_loss], col = 'red', lty = 1)
matlines(low:upp, plot_rolling2_h_w_y[low:upp,mean_test_loss], col = 'red', lty = 1)
matlines(low:upp, plot_rolling2_h_m_y[low:upp,mean_test_loss], col = 'red', lty = 1)
matlines(low:upp, plot_rolling2_w_m_y[low:upp,mean_test_loss], col = 'red', lty = 1)

matlines(low:upp, plot_rolling2_h_w_m_y[low:upp,mean_test_loss], col = 'red', lty = 1)

low = 1
upp = 240
mean(plot_rolling2[low:upp,mean_test_loss])
mean(plot_rolling2_w[low:upp,mean_test_loss])
mean(plot_rolling2_h[low:upp,mean_test_loss])
mean(plot_rolling2_m[low:upp,mean_test_loss])
mean(plot_rolling2_y[low:upp,mean_test_loss])

mean(plot_rolling2_h_w[low:upp,mean_test_loss]) # Best 8.072443
mean(plot_rolling2_h_m[low:upp,mean_test_loss]) 
mean(plot_rolling2_h_y[low:upp,mean_test_loss])

mean(plot_rolling2_w_m[low:upp,mean_test_loss])
mean(plot_rolling2_w_y[low:upp,mean_test_loss])
mean(plot_rolling2_m_y[low:upp,mean_test_loss])

mean(plot_rolling2_h_w_m[low:upp,mean_test_loss])
mean(plot_rolling2_h_w_y[low:upp,mean_test_loss])
mean(plot_rolling2_h_m_y[low:upp,mean_test_loss])
mean(plot_rolling2_w_m_y[low:upp,mean_test_loss])

mean(plot_rolling2_h_w_m_y[low:upp,mean_test_loss])

low = 1
upp = 120
mean(plot_rolling2[low:upp,mean_test_loss])
mean(plot_rolling2_w[low:upp,mean_test_loss])
mean(plot_rolling2_h[low:upp,mean_test_loss]) 
mean(plot_rolling2_m[low:upp,mean_test_loss])
mean(plot_rolling2_y[low:upp,mean_test_loss])

mean(plot_rolling2_h_w[low:upp,mean_test_loss]) #7.275398
mean(plot_rolling2_h_m[low:upp,mean_test_loss]) 
mean(plot_rolling2_h_y[low:upp,mean_test_loss])

mean(plot_rolling2_w_m[low:upp,mean_test_loss])
mean(plot_rolling2_w_y[low:upp,mean_test_loss])
mean(plot_rolling2_m_y[low:upp,mean_test_loss])

mean(plot_rolling2_h_w_m[low:upp,mean_test_loss])
mean(plot_rolling2_h_w_y[low:upp,mean_test_loss])
mean(plot_rolling2_h_m_y[low:upp,mean_test_loss])
mean(plot_rolling2_w_m_y[low:upp,mean_test_loss])

mean(plot_rolling2_h_w_m_y[low:upp,mean_test_loss])

low = 121
upp = 240
mean(plot_rolling2[low:upp,mean_test_loss])
mean(plot_rolling2_w[low:upp,mean_test_loss])
mean(plot_rolling2_h[low:upp,mean_test_loss]) 
mean(plot_rolling2_m[low:upp,mean_test_loss])
mean(plot_rolling2_y[low:upp,mean_test_loss])

mean(plot_rolling2_h_w[low:upp,mean_test_loss]) #Best 8.869488
mean(plot_rolling2_h_m[low:upp,mean_test_loss]) 
mean(plot_rolling2_h_y[low:upp,mean_test_loss])

mean(plot_rolling2_w_m[low:upp,mean_test_loss])
mean(plot_rolling2_w_y[low:upp,mean_test_loss])
mean(plot_rolling2_m_y[low:upp,mean_test_loss])

mean(plot_rolling2_h_w_m[low:upp,mean_test_loss])
mean(plot_rolling2_h_w_y[low:upp,mean_test_loss])
mean(plot_rolling2_h_m_y[low:upp,mean_test_loss])
mean(plot_rolling2_w_m_y[low:upp,mean_test_loss])

mean(plot_rolling2_h_w_m_y[low:upp,mean_test_loss])
```


# Best models
```{r}
#Best models plot
low = 1
upp = 240
matplot(low:upp, plot_rolling0_h_w_m_y[low:upp,mean_test_loss], col = 'red', type = 'l', lty = 1, ylim = c(3,12)) #30-60  9.058161
matlines(low:upp, plot_rolling0_h_w_y[low:upp,mean_test_loss], col = 'black', lty = 1) 

matlines(low:upp, plot_rolling1_h[low:upp,mean_test_loss], col = 'dodgerblue1', lty = 1)   #Best 1-30   7.257886
matlines(low:upp, plot_rolling1_h_m[low:upp,mean_test_loss], col = 'darkturquoise', lty = 1) #Best 1-60   8.117373
matlines(low:upp, plot_rolling1_h_w[low:upp,mean_test_loss], col = 'forestgreen', lty = 1) #Best 30-60  8.847009

matlines(low:upp, plot_rolling2_h_w[low:upp,mean_test_loss], col = 'orange', lty = 1) #Best on all 1-60 8.072443, 1-30 7.275398 30-60  8.869488
#plotz= mod_climate$Results[, .(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
#matlines(low:upp, plotz[low:upp,mean_test_loss], col = 'grey', lty = 1) #Climatology

#mean(plotz[low:upp,mean_test_loss])

#Skillsplot 
S1 = 1 - (plot_rolling1_h_w[low:upp,mean_test_loss]/plot_rolling0_h_w_m_y[low:upp,mean_test_loss])
S2 = 1 - (plot_rolling1_h_w[1:120,mean_test_loss]/plot_rolling0_h_w_m_y[121:upp,mean_test_loss])
S3 = 1 - (plot_rolling1_h_w[121:upp,mean_test_loss]/plot_rolling0_h_w_m_y[121:upp,mean_test_loss])

matplot(low:upp, S1, type = 'l')
abline(h = 0, col = 'red')
abline(h = mean(S1), col = 'orange', lty = 3)
abline(h = mean(S2), col = 'blue', lty = 3)
abline(h = mean(S3), col = 'purple', lty = 3)

matplot(1:120, S2, type = 'l')
abline(h = 0, col = 'red')
abline(h = mean(S2), col = 'blue', lty = 3)

matplot(121:upp, S3, type = 'l')
abline(h = 0, col = 'red')
abline(h = mean(S3), col = 'purple', lty = 3)

```


```{r}
model_to_plot = M_9_60_0_h_w
dat = model_to_plot$Results[month(date) ==1,.(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
colz = c(rep('blue', 2), rep('green', 3),rep('red', 3), rep('brown', 3), 'blue')
plot(dat, type = 'l', ylim = c(0, 25),col = colz[1])
for (i in 2:12){
    lines(model_to_plot$Results[month(date) ==i,.(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)], col = colz[i])
}
#Very seasonal this, lets try merging seasons to see if the pattern is clearer
dat = model_to_plot$Results[month(date) %in% c(12,1,2),.(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)]
colz = c(rep('blue', 2), rep('green', 3),rep('red', 3), rep('brown', 3), 'blue')
plot(dat, type = 'l', ylim = c(0, 25),col = colz[1])

lines(model_to_plot$Results[month(date) %in% c(3,4,5),.(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)], col = colz[3])
lines(model_to_plot$Results[month(date) %in% c(6,7,8),.(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)], col = colz[6])
lines(model_to_plot$Results[month(date) %in% c(9,10,11),.(mean_test_loss = mean(test_loss)), keyby=.(horizon =lead_time)], col = colz[9])
```

```{r}
dat = M_9_60_1_h_w_m_y$Results[yday(date) %in% seq(1:30) & hour ==6,]
dat_cast = dcast(dat, date + hour + PC1 ~ init_date, value_var = c('pred'))
```


